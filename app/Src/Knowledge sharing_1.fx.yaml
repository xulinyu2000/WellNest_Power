"'Knowledge sharing_1' As screen.'phoneLayout_Email_ver3.0'":

    RectQuickActionBar2_1 As rectangle:
        Fill: =RGBA(72, 161, 255, 1)
        Height: =88
        Width: =Parent.Width
        ZIndex: =1

    LblAppName2_1 As label:
        Fill: =RGBA(58, 58, 58, 0)
        Height: =88
        PaddingLeft: =0
        Size: =27
        Text: ="Email"
        Width: =356
        Wrap: =false
        X: =32
        ZIndex: =2

    iconMail1_1 As icon.Send:
        DisabledFill: =RGBA(240, 240, 240, 0.5)
        DisplayMode: |-
            =/*Email must have a subject and recipients to be sent*/
            If(Len(Trim(TextEmailSubject1_1.Text)) > 0 && !IsEmpty(MyPeople), DisplayMode.Edit, DisplayMode.Disabled)
        Height: =88
        Icon: =Icon.Send
        OnSelect: |
            =/*Create semicolon separated list of people to email, send the email, reset subject & message fields          
            Set(_emailRecipientString, Concat(MyPeople, Mail & ";"));           
            Office365Outlook.SendEmail(_emailRecipientString, TextEmailSubject1.Text, TextEmailMessage1.Text, {Importance:"Normal"});           
            Reset(TextEmailSubject1);           
            Reset(TextEmailMessage1);           
            Clear(MyPeople)*/
            
            Set( _emailRecipientString, Concat(MyPeople, Mail & ";") );
            If( IsBlank( UploadedImage1_1 ),
                'Office365Outlook'.SendEmail( _emailRecipientString, 
                    TextEmailSubject1_1.Text, 
                    TextEmailMessage1_1.Text, 
                    { Importance: "Normal" }
                ),
                'Office365Outlook'.SendEmail( _emailRecipientString, 
                    TextEmailSubject1_1.Text, 
                    TextEmailMessage1_1.Text, 
                    {
                        Importance: "Normal",
                        Attachments: Table(
                            {
                                Name: "Image.jpg", 
                                ContentBytes: UploadedImage1_1.Image
                            }
                        )
                    }
                )
            );
            Reset( TextEmailSubject1_1 );
            Reset( TextEmailMessage1_1 );
            Reset( AddMediaButton1_1 );
            Clear( MyPeople ); Navigate('Email Success')
        PaddingBottom: =24
        PaddingLeft: =24
        PaddingRight: =24
        PaddingTop: =24
        Tooltip: ="Send message"
        Width: =88
        X: =Parent.Width - Self.Width
        ZIndex: =3

    LblRecipientCount1_1 As label:
        PaddingLeft: =0
        Size: =18
        Text: ="To (" &CountRows(MyPeople) & ")"
        Width: =EmailPeopleGallery1_1.Width
        Wrap: =false
        X: =32
        Y: =RectQuickActionBar2_1.Height + 15
        ZIndex: =4

    TextSearchBox2_1 As text:
        AccessibleLabel: ="Search people or add email address. At least one recipient is required for a successful submission."
        Default: =""
        Height: =70
        HintText: ="Search people or add email address"
        PaddingLeft: =70
        PressedBorderColor: =TextSearchBox2_1.HoverBorderColor
        PressedColor: =TextSearchBox2_1.Color
        PressedFill: =TextSearchBox2_1.Fill
        Size: =21
        Width: =Parent.Width - Self.X * 2
        X: =32
        Y: =LblRecipientCount1_1.Y + LblRecipientCount1_1.Height + 6
        ZIndex: =5

    SearchIcon2_1 As icon.Search:
        DisabledFill: =SearchIcon2_1.Fill
        Height: =Self.Width
        HoverBorderColor: =ColorFade(SearchIcon2_1.BorderColor, 20%)
        HoverColor: =ColorFade(SearchIcon2_1.Color, 20%)
        HoverFill: =SearchIcon2_1.Fill
        Icon: =Icon.Search
        PaddingBottom: =18
        PaddingLeft: =18
        PaddingRight: =18
        PaddingTop: =18
        PressedBorderColor: =ColorFade(SearchIcon2_1.BorderColor, -20%)
        PressedColor: =ColorFade(SearchIcon2_1.Color, -20%)
        PressedFill: =SearchIcon2_1.Fill
        Tooltip: ="Search"
        Width: =TextSearchBox2_1.Height
        X: =TextSearchBox2_1.X
        Y: =TextSearchBox2_1.Y
        ZIndex: =6

    AddIcon1_1 As icon.Add:
        DisabledFill: =AddIcon1_1.Fill
        Height: =TextSearchBox2_1.Height
        HoverBorderColor: =ColorFade(AddIcon1_1.BorderColor, 20%)
        HoverColor: =ColorFade(AddIcon1_1.Color, 20%)
        HoverFill: =AddIcon1_1.Fill
        Icon: =Icon.Add
        OnSelect: |-
            =Collect(MyPeople,           
            {DisplayName: TextSearchBox2_1.Text, UserPrincipalName: TextSearchBox2_1.Text, Mail: TextSearchBox2_1.Text});           
            Reset(TextSearchBox2_1)
        PaddingBottom: =15
        PaddingLeft: =15
        PaddingRight: =15
        PaddingTop: =15
        PressedBorderColor: =ColorFade(AddIcon1_1.BorderColor, -20%)
        PressedColor: =ColorFade(AddIcon1_1.Color, -20%)
        PressedFill: =AddIcon1_1.Fill
        TabIndex: =0
        Tooltip: ="Select to add user to collection"
        Visible: |-
            =!IsBlank(TextSearchBox2_1.Text) &&           
            
            /*Is user entry a valid email address*/           
            IsMatch(TextSearchBox2_1.Text, Match.Email)           &&
            
            Not(Trim(TextSearchBox2_1.Text) in MyPeople.UserPrincipalName)
        Width: =70
        X: =TextSearchBox2_1.X + TextSearchBox2_1.Width - Self.Width - 10
        Y: =TextSearchBox2_1.Y
        ZIndex: =7

    EmailPeopleGallery1_1 As gallery.SelectedUsersGallery:
        AccessibleLabel: ="User selected people"
        BorderColor: =TextSearchBox2_1.BorderColor
        Fill: =TextSearchBox2_1.Fill
        Height: |-
            =/*Height adjusts to number of items in gallery*/
            Min((Self.TemplateHeight + Self.TemplatePadding * 2) * RoundUp(CountRows(Self.AllItems) / 2, 0), 304)
        Items: |-
            =/*Collection of user selected people*/
            MyPeople
        Layout: =Layout.Vertical
        ShowScrollbar: =Self.Height >= 304
        TemplateSize: =47
        Width: =Parent.Width - Self.X * 2
        WrapCount: =2
        Y: =TextSearchBox2_1.Y + TextSearchBox2_1.Height + 8
        ZIndex: =8

        Rectangle1_1 As rectangle:
            DisabledFill: =Rectangle1_1.Fill
            Height: =Parent.TemplateHeight
            HoverFill: =Rectangle1_1.Fill
            OnSelect: =Select(Parent)
            PressedFill: =Rectangle1_1.Fill
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title3_1 As label:
            FocusedBorderThickness: =2
            Height: =EmailPeopleGallery1_1.TemplateHeight
            OnSelect: =Set(_selectedUser, ThisItem)
            PaddingLeft: =10
            Size: =18
            TabIndex: =If(PeopleBrowseGallery1_1.Visible, -1, 0)
            Text: =ThisItem.DisplayName
            VerticalAlign: =Middle
            Width: =EmailPeopleGallery1_1.TemplateWidth - iconRemove1_1.Width + 10
            Wrap: =false
            ZIndex: =2

        iconRemove1_1 As icon.Cancel:
            AccessibleLabel: =iconRemove1_1.Tooltip
            Color: =Title3_1.Color
            DisabledFill: =iconRemove1_1.Fill
            Height: =EmailPeopleGallery1_1.TemplateHeight
            HoverBorderColor: =ColorFade(iconRemove1_1.BorderColor, 20%)
            HoverColor: =ColorFade(iconRemove1_1.Color, 20%)
            HoverFill: =iconRemove1_1.Fill
            Icon: =Icon.Cancel
            OnSelect: =Remove(MyPeople, LookUp(MyPeople, UserPrincipalName = ThisItem.UserPrincipalName))
            PaddingBottom: =9
            PaddingLeft: =9
            PaddingRight: =9
            PaddingTop: =9
            PressedBorderColor: =ColorFade(iconRemove1_1.BorderColor, -20%)
            PressedColor: =ColorFade(iconRemove1_1.Color, -20%)
            PressedFill: =iconRemove1_1.Fill
            TabIndex: =If(PeopleBrowseGallery1_1.Visible, -1, 0)
            Tooltip: ="Select to remove user from collection"
            Width: =Self.Height
            X: =EmailPeopleGallery1_1.TemplateWidth - Self.Width
            ZIndex: =3

    LblEmailSubject1_1 As label:
        PaddingLeft: =0
        Size: =18
        Text: ="Subject"
        Width: =Parent.Width - Self.X * 2
        Wrap: =false
        X: =32
        Y: =EmailPeopleGallery1_1.Y + EmailPeopleGallery1_1.Height + 16
        ZIndex: =9

    TextEmailSubject1_1 As text:
        AccessibleLabel: ="A subject is required to send an email."
        Default: =""
        Height: =70
        HintText: ="Add a subject"
        PressedBorderColor: =TextEmailSubject1_1.HoverBorderColor
        PressedColor: =TextEmailSubject1_1.Color
        PressedFill: =TextEmailSubject1_1.Fill
        Size: =21
        TabIndex: =If(PeopleBrowseGallery1_1.Visible, -1, 0)
        Width: =Parent.Width - Self.X * 2
        X: =32
        Y: =LblEmailSubject1_1.Y + LblEmailSubject1_1.Height + 6
        ZIndex: =10

    LblEmailMessage1_1 As label:
        PaddingLeft: =0
        Size: =18
        Text: ="Message"
        Width: =200
        Wrap: =false
        X: =32
        Y: =TextEmailSubject1_1.Y + TextEmailSubject1_1.Height + 16
        ZIndex: =11

    TextEmailMessage1_1 As text:
        AccessibleLabel: ="Add a message"
        Default: ="This is can send emails to everybody inside the org. Should we include Teachers when send knowledge to everybody?"
        Height: =584
        HintText: ="Add a message"
        Mode: =TextMode.MultiLine
        PressedBorderColor: =TextEmailMessage1_1.HoverBorderColor
        PressedColor: =TextEmailMessage1_1.Color
        PressedFill: =TextEmailMessage1_1.Fill
        Size: =21
        TabIndex: =If(PeopleBrowseGallery1_1.Visible, -1, 0)
        Width: =586
        X: =32
        Y: =LblEmailMessage1_1.Y + LblEmailMessage1_1.Height + 6
        ZIndex: =12

    Button14_2 As button:
        BorderColor: =ColorFade(Button14_2.Fill, -15%)
        Fill: =RGBA(72, 161, 255, 1)
        Height: =70
        HoverBorderColor: =ColorFade(Button14_2.BorderColor, 20%)
        OnSelect: =Back()
        PressedBorderColor: =Button14_2.Fill
        PressedColor: =Button14_2.Fill
        PressedFill: =Button14_2.Color
        Size: =24
        Text: ="Back"
        Width: =280
        X: =187
        Y: =1046
        ZIndex: =15

    AddMediaWithImage1_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =15

        UploadedImage1_1 As image:
            Height: =328
            HoverBorderColor: =ColorFade(UploadedImage1_1.BorderColor, 20%)
            HoverFill: =ColorFade(UploadedImage1_1.Fill, 20%)
            Image: =If(IsBlank(AddMediaButton1_1.Media), SampleImage, AddMediaButton1_1.Media)
            ImagePosition: =ImagePosition.Fill
            PressedBorderColor: =ColorFade(UploadedImage1_1.BorderColor, -20%)
            PressedFill: =ColorFade(UploadedImage1_1.Fill, -20%)
            Width: =436
            X: =104
            Y: =655
            ZIndex: =13

        AddMediaButton1_1 As addMedia:
            Height: =328
            HoverBorderColor: =ColorFade(AddMediaButton1_1.BorderColor, 20%)
            HoverColor: =AddMediaButton1_1.Color
            HoverFill: =ColorFade(AddMediaButton1_1.Fill, 20%)
            PressedBorderColor: =ColorFade(AddMediaButton1_1.BorderColor, -20%)
            PressedColor: =AddMediaButton1_1.Color
            PressedFill: =ColorFade(AddMediaButton1_1.Fill, -20%)
            Size: =25
            Width: =436
            X: =99
            Y: =655
            ZIndex: =14

    PeopleBrowseGallery1_1 As gallery.PeoplePickerGallerySmall:
        AccessibleLabel: ="User look up search results"
        BorderThickness: =2
        Fill: =Parent.Fill
        Height: =If(Self.Visible, Parent.Height / 2 + 200, 0)
        Items: |-
            =/*Only use Office 365 Users operation if user has started searching*/
            If(!IsBlank(Trim(TextSearchBox3.Text)), Office365Users.SearchUser({searchTerm: Trim(TextSearchBox3.Text), top: 15}))
        Layout: =Layout.Vertical
        TemplatePadding: =0
        TemplateSize: =104
        Visible: =!IsBlank(Trim(TextSearchBox3.Text))
        Width: =Parent.Width - Self.X * 2
        X: =52
        Y: =TextSearchBox3.Y + TextSearchBox3.Height
        ZIndex: =16

        Rectangle5_1 As rectangle:
            BorderColor: =Title5_1.Color
            BorderThickness: =If(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName, 4, 0)
            DisabledFill: =Rectangle5_1.Fill
            Fill: =RGBA(0,0,0,0)
            Height: =Parent.TemplateHeight
            HoverFill: =RGBA(0,0,0,0)
            OnSelect: =Select(Title5_1)
            PressedFill: =Rectangle5_1.Fill
            Width: =Parent.TemplateWidth
            ZIndex: =1

        Title5_1 As label:
            BorderColor: =Self.Color
            FocusedBorderThickness: =2
            OnSelect: |-
                =/*Select user, clear search contents and if this user hasn't been added to MyPeople collection, add them*/
                Concurrent(
                Set(_selectedUser, ThisItem),
                Reset(TextSearchBox3),
                If(Not(ThisItem.UserPrincipalName in MyPeople.UserPrincipalName), Collect(MyPeople, ThisItem)))
            Size: =21
            TabIndex: =0
            Text: =ThisItem.DisplayName
            VerticalAlign: =Middle
            Width: =PeopleBrowseGallery1_1.TemplateWidth - 2 * Self.X
            Wrap: =false
            X: =16
            Y: =4
            ZIndex: =2

        Subtitle1_1 As label:
            Color: =ColorFade(Title5_1.Color, 0.20)
            FocusedBorderThickness: =2
            OnSelect: =Select(Title5_1)
            Size: =21
            Text: =ThisItem.UserPrincipalName
            VerticalAlign: =Middle
            Width: =PeopleBrowseGallery1_1.TemplateWidth - 2 * Self.X
            Wrap: =false
            X: =Title5_1.X
            Y: =Title5_1.Y + Title5_1.Height + 3
            ZIndex: =3

        Separator1_1 As rectangle:
            Height: =1
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - 1
            ZIndex: =4

